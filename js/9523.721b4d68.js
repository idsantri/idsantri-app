"use strict";(globalThis["webpackChunkidsantri_app"]=globalThis["webpackChunkidsantri_app"]||[]).push([[9523],{9523:(a,e,l)=>{l.r(e),l.d(e,{default:()=>j});var n=l(1347),t=l(1734),u=l(4187),i=l(455),s=l(5455),d=l(3336),o=l(528),r=l(8633),v=l(7763),c=l(2364),m=l(6397),g=l(8158),p=l(7543),b=l(2010);const k={key:0},_={__name:"KelasIzinCrud",props:{data:{type:Object,required:!0},isNew:{type:Boolean,default:!0},title:{type:String,default:()=>"Input"}},emits:["successSubmit","successDelete"],setup(a,{emit:e}){const l=a,t=e,i=(0,u.KR)({keperluan:"Sakit",durasi:1}),s=(0,u.KR)([]),o=(0,u.KR)([]),_=(0,u.KR)(!1);(0,n.sV)((async()=>{Object.assign(i.value,l.data),await(0,b.Mr)({key:"keperluan-izin",loading:o,lists:s,sort:!0}),await(0,b.Mr)({key:"keterangan-izin",loading:o,lists:s,sort:!0})}));const h=async()=>{const a={kelas_id:i.value.kelas_id,dari_tgl:i.value.dari_tgl,durasi:i.value.durasi,keperluan:i.value.keperluan,keterangan:i.value.keterangan,catatan:i.value.catatan};let e=null;e=l.isNew?await(0,g.A)({endPoint:"izin-madrasah",data:a,loading:_}):await(0,m.A)({endPoint:`izin-madrasah/${i.value.id}`,data:a,confirm:!0,notify:!0,loading:_}),e&&(document.getElementById("btn-close-crud").click(),t("successSubmit"))},V=async()=>{const a=await(0,p.A)({endPoint:`izin-madrasah/${i.value.id}`,loading:_,rerender:!1});a&&(document.getElementById("btn-close-crud").click(),t("successDelete"))};return(e,t)=>{const m=(0,n.g2)("q-card-section"),g=(0,n.g2)("q-spinner-cube"),p=(0,n.g2)("q-dialog"),b=(0,n.g2)("q-input"),F=(0,n.g2)("q-select"),f=(0,n.g2)("q-btn"),q=(0,n.g2)("q-space"),A=(0,n.g2)("q-card-actions"),K=(0,n.g2)("q-form"),w=(0,n.g2)("q-card"),y=(0,n.gN)("close-popup");return(0,n.uX)(),(0,n.Wv)(w,{class:"full-width",style:{"max-width":"425px"}},{default:(0,n.k6)((()=>[(0,n.bF)(K,{onSubmit:(0,r.D$)(h,["prevent"])},{default:(0,n.k6)((()=>[(0,n.bF)(m,{class:"bg-green-7 text-green-11 q-pa-sm"},{default:(0,n.k6)((()=>[(0,n.bF)(c.A,{onEmitButton:a=>null},{default:(0,n.k6)((()=>[(0,n.eW)((0,v.v_)(l.title)+" â€” ",1),(0,n.Lk)("em",null,(0,v.v_)(a.isNew?"baru":"edit"),1)])),_:1})])),_:1}),(0,n.bF)(m,null,{default:(0,n.k6)((()=>[_.value?((0,n.uX)(),(0,n.CE)("div",k,[(0,n.bF)(p,{modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=a=>_.value=a),persistent:""},{default:(0,n.k6)((()=>[(0,n.bF)(g,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})])),_:1},8,["modelValue"])])):(0,n.Q3)("",!0),(0,n.bF)(b,{dense:"",outlined:"",label:"Nama","model-value":i.value?.nama+" ("+i.value?.santri_id+")",disable:"",filled:""},null,8,["model-value"]),(0,n.bF)(b,{dense:"",class:"q-mt-sm",outlined:"",label:"Data Kelas","model-value":i.value?.th_ajaran_h+" | "+i.value?.tingkat_id+" | "+i.value?.kelas,disable:"",filled:""},null,8,["model-value"]),(0,n.bF)(b,{dense:"",hint:(0,u.R1)(d.$P)(i.value.dari_tgl)?(0,u.R1)(d.H6)(i.value.dari_tgl):"",class:"q-mt-sm",outlined:"",label:"Tanggal (M)*",modelValue:i.value.dari_tgl,"onUpdate:modelValue":t[1]||(t[1]=a=>i.value.dari_tgl=a),type:"date",rules:[a=>!!a||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"]),(0,n.bF)(b,{dense:"",class:"q-mt-sm",outlined:"",label:"Durasi (hari)*",modelValue:i.value.durasi,"onUpdate:modelValue":t[2]||(t[2]=a=>i.value.durasi=a),rules:[a=>!!a||"Harus diisi!",a=>!a||!isNaN(a)||"Hanya angka"],"error-color":"negative"},null,8,["modelValue","rules"]),(0,n.bF)(F,{dense:"",class:"q-mt-sm",outlined:"",label:"Keperluan*","emit-value":"","map-options":"",modelValue:i.value.keperluan,"onUpdate:modelValue":t[3]||(t[3]=a=>i.value.keperluan=a),options:s.value["keperluan-izin"],loading:o.value["keperluan-izin"],rules:[a=>!!a||"Harus diisi!"],behavior:"menu"},null,8,["modelValue","options","loading","rules"]),(0,n.bF)(F,{dense:"",class:"q-mt-sm",outlined:"",label:"Keterangan","emit-value":"","map-options":"",modelValue:i.value.keterangan,"onUpdate:modelValue":t[4]||(t[4]=a=>i.value.keterangan=a),options:s.value["keterangan-izin"],loading:o.value["keterangan-izin"],clearable:"",behavior:"menu"},null,8,["modelValue","options","loading"]),(0,n.bF)(b,{dense:"",class:"q-mt-sm",outlined:"",label:"Catatan",modelValue:i.value.catatan,"onUpdate:modelValue":t[5]||(t[5]=a=>i.value.catatan=a),autogrow:""},null,8,["modelValue"])])),_:1}),(0,n.bF)(A,{class:"flex bg-green-6"},{default:(0,n.k6)((()=>[(0,n.bo)((0,n.bF)(f,{label:"Hapus",class:"bg-red text-red-1","no-caps":"",onClick:V},null,512),[[r.aG,!l.isNew]]),(0,n.bF)(q),(0,n.bo)((0,n.bF)(f,{label:"Tutup",class:"bg-green-11","no-caps":"",id:"btn-close-crud"},null,512),[[y]]),(0,n.bF)(f,{type:"submit",label:"Simpan",class:"bg-green-10 text-green-11","no-caps":""})])),_:1})])),_:1})])),_:1})}}};var h=l(3341),V=l(3417),F=l(222),f=l(45),q=l(1402),A=l(6395),K=l(4611),w=l(5034),y=l(2677),z=l(5873),R=l(1038),C=l(272),S=l.n(C);const Q=_,D=Q;S()(_,"components",{QCard:h.A,QForm:V.A,QCardSection:F.A,QDialog:f.A,QSpinnerCube:q.A,QInput:A.A,QSelect:K.A,QCardActions:w.A,QBtn:y.A,QSpace:z.A}),S()(_,"directives",{ClosePopup:R.A});var I=l(9463),x=l(5605);const N={__name:"KelasIzin",setup(a){const e=(0,i.lq)(),l=e.params,r=(0,u.KR)([]),v=(0,u.KR)([]),c=(0,u.KR)({}),m=(0,u.KR)(!1),g=(0,u.KR)(!1),p=(0,u.KR)(!1),b=(0,u.KR)({}),k=(0,u.KR)("");async function _(){const a=await(0,t.A)({endPoint:`izin-madrasah/kelas/${l.id}`,loading:m});r.value=a.izin_madrasah,b.value=a.kelas,v.value=a.izin_madrasah.map((a=>({Tanggal:(0,d.kz)(a.dari_tgl)+" | "+(0,o.kh)((0,o.cE)(a.dari_tgl)),Durasi:a.durasi+" hari",Keperluan:a.keperluan+""+(a.keterangan?.length>0?" ("+a.keterangan+")":""),Catatan:a.catatan,id:a.id})))}(0,n.sV)((async()=>{await _()}));const h=()=>{c.value.santri_id=b.value.santri_id,c.value.nama=b.value.nama,c.value.th_ajaran_h=b.value.th_ajaran_h,c.value.tingkat_id=b.value.tingkat_id,c.value.kelas=b.value.kelas,c.value.kelas_id=b.value.id,g.value=!0,p.value=!0},V=({id:a})=>{c.value=(0,I.I)(r,a),c.value.santri_id=b.value.santri_id,c.value.nama=b.value.nama,c.value.th_ajaran_h=b.value.th_ajaran_h,c.value.tingkat_id=b.value.tingkat_id,c.value.kelas=b.value.kelas,g.value=!1,p.value=!0},F=(0,u.KR)(!1);function f(a){k.value=`reports/izin-madrasah/view?id=${a.id}`,F.value=!0}return(a,e)=>{const l=(0,n.g2)("q-dialog");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(s.A,{data:v.value,spinner:m.value,"btn-print":!0,onAdd:h,onEdit:V,onPrint:f},null,8,["data","spinner"]),(0,n.bF)(l,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=a=>p.value=a)},{default:(0,n.k6)((()=>[(0,n.bF)(D,{data:c.value,"is-new":g.value,title:"Input Izin Madrasah",onSuccessSubmit:_,onSuccessDelete:_},null,8,["data","is-new"])])),_:1},8,["modelValue"]),(0,n.bF)(l,{modelValue:F.value,"onUpdate:modelValue":e[1]||(e[1]=a=>F.value=a)},{default:(0,n.k6)((()=>[(0,n.bF)(x.A,{url:k.value},null,8,["url"])])),_:1},8,["modelValue"])],64)}}},U=N,j=U;S()(N,"components",{QDialog:f.A})}}]);