"use strict";(globalThis["webpackChunkidsantri_app"]=globalThis["webpackChunkidsantri_app"]||[]).push([[9523],{69523:(a,e,l)=>{l.r(e),l.d(e,{default:()=>$});var n=l(51347),u=l(34187),t=l(60455),i=l(23336),s=l(30528),d=l(69463),r=l(21734),o=l(1995),c=l(95455),v=l(8633),m=l(37763),g=l(52364),p=l(6397),b=l(68158),k=l(47543),_=l(90486);const h={key:0},V={__name:"KelasIzinCrud",props:{data:{type:Object,required:!0},isNew:{type:Boolean,default:!0},title:{type:String,default:()=>"Input"}},emits:["successSubmit","successDelete"],setup(a,{emit:e}){const l=a,t=e,s=(0,u.KR)({keperluan:"Sakit",durasi:1}),d=(0,u.KR)(!1);(0,n.sV)((async()=>{Object.assign(s.value,l.data)}));const r=async()=>{const a={kelas_id:s.value.kelas_id,dari_tgl:s.value.dari_tgl,durasi:s.value.durasi,keperluan:s.value.keperluan,keterangan:s.value.keterangan,catatan:s.value.catatan};let e=null;e=l.isNew?await(0,b.A)({endPoint:"izin-madrasah",data:a,loading:d}):await(0,p.A)({endPoint:`izin-madrasah/${s.value.id}`,data:a,confirm:!0,notify:!0,loading:d}),e&&(document.getElementById("btn-close-crud").click(),t("successSubmit"))},o=async()=>{const a=await(0,k.A)({endPoint:`izin-madrasah/${s.value.id}`,loading:d,rerender:!1});a&&(document.getElementById("btn-close-crud").click(),t("successDelete"))};return(e,t)=>{const c=(0,n.g2)("q-card-section"),p=(0,n.g2)("q-spinner-cube"),b=(0,n.g2)("q-dialog"),k=(0,n.g2)("q-input"),V=(0,n.g2)("q-btn"),F=(0,n.g2)("q-space"),A=(0,n.g2)("q-card-actions"),f=(0,n.g2)("q-form"),q=(0,n.g2)("q-card"),K=(0,n.gN)("close-popup");return(0,n.uX)(),(0,n.Wv)(q,{class:"full-width",style:{"max-width":"425px"}},{default:(0,n.k6)((()=>[(0,n.bF)(f,{onSubmit:(0,v.D$)(r,["prevent"])},{default:(0,n.k6)((()=>[(0,n.bF)(c,{class:"bg-green-7 text-green-11 q-pa-sm"},{default:(0,n.k6)((()=>[(0,n.bF)(g.A,{onEmitButton:a=>null},{default:(0,n.k6)((()=>[(0,n.eW)((0,m.v_)(l.title)+" â€” ",1),(0,n.Lk)("em",null,(0,m.v_)(a.isNew?"baru":"edit"),1)])),_:1})])),_:1}),(0,n.bF)(c,null,{default:(0,n.k6)((()=>[d.value?((0,n.uX)(),(0,n.CE)("div",h,[(0,n.bF)(b,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=a=>d.value=a),persistent:""},{default:(0,n.k6)((()=>[(0,n.bF)(p,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})])),_:1},8,["modelValue"])])):(0,n.Q3)("",!0),(0,n.bF)(k,{dense:"",outlined:"",label:"Nama","model-value":s.value?.nama+" ("+s.value?.santri_id+")",disable:"",filled:""},null,8,["model-value"]),(0,n.bF)(k,{dense:"",class:"q-mt-sm",outlined:"",label:"Data Kelas","model-value":s.value?.th_ajaran_h+" | "+s.value?.tingkat_id+" | "+s.value?.kelas,disable:"",filled:""},null,8,["model-value"]),(0,n.bF)(k,{dense:"",hint:(0,u.R1)(i.$P)(s.value.dari_tgl)?(0,u.R1)(i.H6)(s.value.dari_tgl):"",class:"q-mt-sm",outlined:"",label:"Tanggal (M)*",modelValue:s.value.dari_tgl,"onUpdate:modelValue":t[1]||(t[1]=a=>s.value.dari_tgl=a),type:"date",rules:[a=>!!a||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"]),(0,n.bF)(k,{dense:"",class:"q-mt-sm",outlined:"",label:"Durasi (hari)*",modelValue:s.value.durasi,"onUpdate:modelValue":t[2]||(t[2]=a=>s.value.durasi=a),rules:[a=>!!a||"Harus diisi!",a=>!a||!isNaN(a)||"Hanya angka"],"error-color":"negative"},null,8,["modelValue","rules"]),(0,n.bF)(_.A,{modelValue:s.value.keperluan,"onUpdate:modelValue":t[3]||(t[3]=a=>s.value.keperluan=a),url:"keperluan-izin",label:"Keperluan *",class:"q-mt-sm",rules:[a=>!!a||"Harus diisi!"]},null,8,["modelValue","rules"]),(0,n.bF)(_.A,{modelValue:s.value.keterangan,"onUpdate:modelValue":t[4]||(t[4]=a=>s.value.keterangan=a),url:"keterangan-izin",label:"Keterangan",class:"q-mt-sm"},null,8,["modelValue"]),(0,n.bF)(k,{dense:"",class:"q-mt-sm",outlined:"",label:"Catatan",modelValue:s.value.catatan,"onUpdate:modelValue":t[5]||(t[5]=a=>s.value.catatan=a),autogrow:""},null,8,["modelValue"])])),_:1}),(0,n.bF)(A,{class:"flex bg-green-6"},{default:(0,n.k6)((()=>[(0,n.bo)((0,n.bF)(V,{label:"Hapus",class:"bg-red text-red-1","no-caps":"",onClick:o},null,512),[[v.aG,!l.isNew]]),(0,n.bF)(F),(0,n.bo)((0,n.bF)(V,{label:"Tutup",class:"bg-green-11","no-caps":"",id:"btn-close-crud"},null,512),[[K]]),(0,n.bF)(V,{type:"submit",label:"Simpan",class:"bg-green-10 text-green-11","no-caps":""})])),_:1})])),_:1})])),_:1})}}};var F=l(83341),A=l(53417),f=l(60222),q=l(30045),K=l(71402),w=l(46395),y=l(25034),z=l(22677),C=l(5873),R=l(61038),S=l(272),Q=l.n(S);const D=V,I=D;Q()(V,"components",{QCard:F.A,QForm:A.A,QCardSection:f.A,QDialog:q.A,QSpinnerCube:K.A,QInput:w.A,QCardActions:y.A,QBtn:z.A,QSpace:C.A}),Q()(V,"directives",{ClosePopup:R.A});var x=l(75605);const N={__name:"KelasIzin",setup(a){const e=(0,t.lq)(),l=e.params,v=(0,u.KR)([]),m=(0,u.KR)([]),g=(0,u.KR)({}),p=(0,u.KR)(!1),b=(0,u.KR)(!1),k=(0,u.KR)(!1),_=(0,u.KR)({}),h=(0,u.KR)("");async function V(){const a=await(0,r.A)({endPoint:`izin-madrasah/kelas/${l.id}`,loading:p});v.value=a.izin_madrasah,_.value=a.kelas,m.value=a.izin_madrasah.map((a=>({Tanggal:(0,i.kz)(a.dari_tgl)+" | "+(0,s.kh)((0,s.cE)(a.dari_tgl)),Durasi:a.durasi+" hari",Keperluan:a.keperluan+""+(a.keterangan?.length>0?" ("+a.keterangan+")":""),Catatan:a.catatan,id:a.id})))}(0,n.sV)((async()=>{await V()}));const F=()=>{g.value={},g.value.santri_id=_.value.santri_id,g.value.nama=_.value.nama,g.value.th_ajaran_h=_.value.th_ajaran_h,g.value.tingkat_id=_.value.tingkat_id,g.value.kelas=_.value.kelas,g.value.kelas_id=_.value.id,b.value=!0,k.value=!0},A=({id:a})=>{g.value={},g.value=(0,d.I$)(v,a),g.value.santri_id=_.value.santri_id,g.value.nama=_.value.nama,g.value.th_ajaran_h=_.value.th_ajaran_h,g.value.tingkat_id=_.value.tingkat_id,g.value.kelas=_.value.kelas,b.value=!1,k.value=!0},f=(0,u.KR)(!1);function q(a){h.value=`reports/izin-madrasah/view?id=${a.id}&token=${(0,o.A)()}`,f.value=!0}return(a,e)=>{const l=(0,n.g2)("q-dialog");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(c.A,{data:m.value,spinner:p.value,"btn-print":!0,onAdd:F,onEdit:A,onPrint:q},null,8,["data","spinner"]),(0,n.bF)(l,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=a=>k.value=a)},{default:(0,n.k6)((()=>[(0,n.bF)(I,{data:g.value,"is-new":b.value,title:"Input Izin Madrasah",onSuccessSubmit:V,onSuccessDelete:V},null,8,["data","is-new"])])),_:1},8,["modelValue"]),(0,n.bF)(l,{modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=a=>f.value=a)},{default:(0,n.k6)((()=>[(0,n.bF)(x.A,{url:h.value},null,8,["url"])])),_:1},8,["modelValue"])],64)}}},U=N,$=U;Q()(N,"components",{QDialog:q.A})}}]);